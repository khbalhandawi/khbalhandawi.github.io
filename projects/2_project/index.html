<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Khalil  Al Handawi | COVID-19 forecasting</title>
<meta name="description" content="Khalil Al Handawi's research portfolio.
">
<meta name="robots" content="noindex, nofollow">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://raw.githubusercontent.com/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>K</text></svg>">

<link rel="stylesheet" href="/assets/css/main.css">

<link rel="canonical" href="/projects/2_project/">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->

  <script src="/assets/js/theme.js"></script>
  <!-- Load DarkMode JS -->
<script src="/assets/js/dark_mode.js"></script>






    
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


    <script src="/assets/js/distillpub/template.v2.js"></script>
  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="/">
       <span class="font-weight-bold">Khalil</span>   Al Handawi
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              about
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/CV/">
                CV
                
              </a>
          </li>
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/projects/">
                projects
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                publications
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/teaching/">
                teaching
                
              </a>
          </li>
          
          
          
            <div class = "toggle-container">
              <a id = "light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      <div class="post">

  <header class="post-header">
    <h1 class="post-title">COVID-19 forecasting</h1>
    <p class="post-description">Infectious disease prediction using machine learning</p>
  </header>

  <article>
    <p><em>How can we use data from a cross-sectional cohort of patients to predict COVID-19 rates at the national level?</em></p>

<p>To answer this question, we collected data representative of the COVID-19 pandemic patients in Lebanon from Rafic Hariri University Hospital (RHUH). We analyzed said data for trends in COVID-19 incidence. The main indicator related to COVID-19 rates in this study is the cycle threshold (Ct) value obtained from Reverse-transcription quantitative polymerase chain reaction (RT-qPCR) tests conducted on the patients. This value is normally discarded and only the diagnostic result of the test is reported.</p>

<p>The figure below shows that a sharp rise in Ct leads to an increase in the number of cases observed nationwide. Although this result is expected, there is a lag between the two events. This is explained by population dynamics and the rate at which the disease spreads. Most machine learning models can capture the inverse relationship between the two features (\(n_\text{cases}\), and Ct) but only recurrent neural networks (RNNs) can capture the ‘lag’ or  temporal effect.</p>

<script>
    var index = 0;

    function changeBanner() {

        loop_imgs = document.getElementById("animation").children;
        
        [].forEach.call(loop_imgs, function(v, i) {
            loop_imgs[i].hidden = i !== index
        });
        index = (index + 1) % loop_imgs.length;
    }
    window.onload = function() {
        setInterval(changeBanner, 1000)
    };
</script>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <div id="animation">
            <img class="img-fluid rounded z-depth-1" src="/assets/img/LSTM/raw_data/animation_0.png" alt="" title="COVID simulation" hidden="" />
            <img class="img-fluid rounded z-depth-1" src="/assets/img/LSTM/raw_data/animation_1.png" alt="" title="COVID simulation" hidden="" />
            <img class="img-fluid rounded z-depth-1" src="/assets/img/LSTM/raw_data/animation_2.png" alt="" title="COVID simulation" hidden="" />
            <img class="img-fluid rounded z-depth-1" src="/assets/img/LSTM/raw_data/animation_3.png" alt="" title="COVID simulation" hidden="" />
        </div>
    </div>
</div>
<div class="caption">
    Tracking the COVID-19 pandemic in Lebanon and the corresponding Ct values of the patient cohort at Rafic Hariri University Hospital (RHUH)
</div>

<p>An encoder RNN was used to capture the effects of Ct and past \(n_\text{cases}\). A decoder RNN was used to forecast the future rise in \(n_\text{cases}\). The structure of these networks is determining by their <em>hyperparameters</em>. Stochastic optimization <a href="https://arxiv.org/abs/1911.01012" target="_blank"><code class="language-plaintext highlighter-rouge">StoMADS</code></a> was used to optimize the neural network’s hyperparamters such that the validation error is minimized. This resulted in an impressively low value for the test score on the unseen dataset. The effect of optimization the hyperparameters is shown below for a few examples. Click the button below to cycle through the different models and their hyperparameters.</p>

<script>
    // image sources in array. image[0] will have first image src, image[2] will have last src
    var images_1 = [
        "/assets/img/LSTM/HPO/model_scheme_001.png",
        "/assets/img/LSTM/HPO/model_scheme_002.png",
        "/assets/img/LSTM/HPO/model_scheme_003.png"
    ]

    var images_2 = [
        "/assets/img/LSTM/HPO/model_tuned_1.png",
        "/assets/img/LSTM/HPO/model_tuned_2.png",
        "/assets/img/LSTM/HPO/model_tuned_3.png"
    ]

    var step = 0;
    changeImage(); // set first image src after page loads

    function changeImage() {
        // exit if no images, or step = number of items in array
        if (typeof images_1 == "undefined" ||  step == images_1.length) return;     
        if (typeof images_2 == "undefined" ||  step == images_2.length) return; 

        document.getElementById('click_animation_1').src = images_1[step];
        document.getElementById('click_animation_2').src = images_2[step];
        if (step == 2) {
            step=0;
        } else {
            step++;
        }

    }
</script>

<div style="text-align: center; border: 0px solid">
    <button type="button" onclick="changeImage()">
        Cycle through models
    </button>
</div>

<p></p>

<div class="row justify-content-sm-center equal-height-medium ">
    <div class="col-sm-7 mt-1 mt-md-0">
        <img id="click_animation_1" class="img-fluid rounded z-depth-1" alt="" title="arbitrary policies" />
    </div>
    <div class="col-sm-5 mt-1 mt-md-0">
        <img id="click_animation_2" class="img-fluid rounded z-depth-1" alt="" title="optimal policies" />
    </div>
</div>
<div class="caption">
    Structure of the RNN encoder/decoder paradigm (left) and corresponding predictions (right)
</div>

<p>The final trained model is made publicly available for inference on  <a href="https://covid-forecaster-lebanon.herokuapp.com/" target="_blank"><code class="language-plaintext highlighter-rouge">https://covid-forecaster-lebanon.herokuapp.com/</code></a>.</p>

<p><a href="https://www.mdpi.com/1999-4915/14/7/1414" target="_blank"><i class="fas fa-book"></i> publication</a>  
<a href="https://covid-forecaster-lebanon.herokuapp.com/" target="_blank"> <i class="fab fa-github"></i> heroku app</a></p>


  </article>

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    &copy; Copyright 2024 Khalil  Al Handawi.
    Hosted by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>.

    
    
    Last updated: February 16, 2024.
    
  </div>
</footer>



  </body>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>


  <d-bibliography src="/assets/bibliography/">
  </d-bibliography>

</html>
